<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="Vegetable Blog" href="http://ericcd.com/rss.xml"><link rel="alternate" type="application/atom+xml" title="Vegetable Blog" href="http://ericcd.com/atom.xml"><link rel="alternate" type="application/json" title="Vegetable Blog" href="http://ericcd.com/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="web"><link rel="canonical" href="http://ericcd.com/2022/11/30/hvv/"><title>面经 - web | Yume Shoka = Vegetable Blog</title><meta name="generator" content="Hexo 6.1.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">面经</h1><div class="meta"><span class="item" title="创建时间：2022-11-30 14:26:13"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2022-11-30T14:26:13+08:00">2022-11-30</time></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Yume Shoka</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://ericcd-wallpaper.oss-cn-hangzhou.aliyuncs.com/img/1.png"></li><li class="item" data-background-image="https://ericcd-wallpaper.oss-cn-hangzhou.aliyuncs.com/img/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20230131214807.jpg"></li><li class="item" data-background-image="https://ericcd-wallpaper.oss-cn-hangzhou.aliyuncs.com/img/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_202301312148074.jpg"></li><li class="item" data-background-image="https://ericcd-wallpaper.oss-cn-hangzhou.aliyuncs.com/img/2.jpg"></li><li class="item" data-background-image="https://ericcd-wallpaper.oss-cn-hangzhou.aliyuncs.com/img/4.jpg"></li><li class="item" data-background-image="https://ericcd-wallpaper.oss-cn-hangzhou.aliyuncs.com/img/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_202301312148073.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/web/" itemprop="item" rel="index" title="分类于 web"><span itemprop="name">web</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://ericcd.com/2022/11/30/hvv/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="EricCD"><meta itemprop="description" content=", "></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Vegetable Blog"></span><div class="body md" itemprop="articleBody"><p>面经总结<br><span id="more"></span></p><h1 id="个人知识扫盲"><a class="anchor" href="#个人知识扫盲">#</a> 个人知识扫盲</h1><p>1.waf<br>Web 应用防护系统（也称为：网站应用级入侵防御系统。英文：Web Application Firewall，简称： WAF）。利用国际上公认的一种说法：Web 应用防火墙是通过执行一系列针对 HTTP/HTTPS 的安全策略来专门为 Web 应用提供保护的一款产品。</p><p>2.ips<br>入侵防御系统 (IPS: Intrusion Prevention System) 是电脑网络安全设施，是对防病毒软件（Antivirus Programs）和防火墙 (Packet Filter, Application Gateway) 的补充。 入侵防御系统 (Intrusion-prevention system) 是一部能够监视网络或网络设备的网络资料传输行为的计算机网络安全设备，能够及时的中断、调整或隔离一些不正常或是具有伤害性的网络资料传输行为，能够帮助组织识别恶意流量，并主动阻止此类流量进入其网络。。<br>IPS 一般也是在网络层旁路，可以理解为具备阻断能力的 IDS，是 IDS 的升级版（也有 IDS 检测到攻击通知阻断设备执行阻断动作的设备联动模式），可以覆盖网络层和应用层。</p><p>3.ids<br>IDS（intrusion detection system）入侵检测系统是一种对网络传输进行即时监视，在发现可疑传输时发出警报或者采取主动反应措施的网络安全设备。它与其他网络安全设备的不同之处便在于，IDS 是一种积极主动的安全防护技术。<br>IDS 工作在网络层，旁路部署，通过抓取和分析网络流量来发现攻击，主要关注网络层和传输层的数据包，如 IP、TCP、UDP 等协议。<br>产品：奇安信天眼</p><ol start="4"><li><p>旁路部署<br>旁路部署是指安全设备在网络结构中处于旁路状态。在旁路模式下，安全设备只需要连接到交换机的指定镜像端口，所以形象的称之为 “旁路监控”；而串联模式一般是通过网关或者网桥的模式来进行监控，由于监控设备做了网关或者网桥，所以形象的称之为 “串联监控”。<br>旁路部署可以应用于防毒墙、IDS、上网行为审计、流控等很多安全设备。</p></li><li><p>交换机<br>交换机工作在 OSI 模型的第二层，即数据链路层。 交换机的主要作用是连接多个以太网物理段，隔离冲突域，对以太网帧进行高速而透明的交换转发，自行学习和维护 MAC 地址信息。 希望这能帮到你。</p></li><li><p>路由器<br>路由器属于 OSI 模型的第三层，即网络层。路由器的基本功能是把数据（IP 报文）传送到正确的网络，包括数据报的寻径和传送，子网隔离，抑制广播风暴，维护路由表，并与其它路由器交换路由信息，这是 IP 报文转发的基础，实现对 IP 数据报的过滤和记帐。</p></li><li><p>交换机和路由器之间的关系<br>交换机负责连接网络设备（如交换机、路由器、防火墙、无线 AP 等）和终端设备（如计算机、服务器、摄像头、打印机等）；路由器实现局域网与局域网的互联，局域网与 Internet 的互联。<br>交换机不懂得 IP 地址，但它可以 “学习” MAC 地址，并把其存放在内部地址表中，通过在数据帧的始发者和目标接收者之间建立临时的交换路径，使数据帧直接由源地址到达目的地址。<br>普通的交换机一般工作在 OSI 七层模型的第二层 - 数据链路层，负责局域网之间的连接，而路由器工作在 OSI 的第三层 - 网络层，负责广域网之间的连接。<br>交换机都是根据 MAC 地址转发数据帧，而路由器是基于路由表转发数据包。<br>总而言之，交换机是将不同 IP 地址的电脑连在一起，共享一根网线；路由器是将同一个 IP 给不同的电脑使用，就像一条大路分成很多条小路。一句话，路由器是接外网的，交换机是接内网的。</p></li><li><p>数据包从前端到后端的流程<br>客户端向服务器发起请求，请求会被封装成数据包。<br>数据包会经过客户端的网卡，然后通过网线传输到路由器。<br>路由器会根据目标 IP 地址，将数据包转发到下一个路由器或者直接转发到目标服务器。<br>数据包到达目标服务器后，会被服务器的网卡接收。<br>服务器会对数据包进行解析，然后根据请求内容进行处理。<br>服务器处理完请求后，会将响应结果封装成数据包，然后通过网卡发送回客户端。<br>数据包会经过路由器，然后通过网线传输到客户端的网卡。<br>客户端的网卡接收到数据包后，会将数据包传递给操作系统内核。<br>操作系统内核会对数据包进行解析，然后将响应结果交给应用程序。</p></li></ol><p>9.NAT<br>NAT 是指网络地址转换，是一种网络协议。当在专用网内部的一些主机本来已经分配到了本地 IP 地址（即仅在本专用网内使用的专用地址），但又想和因特网上的主机通信（并不需要加密）时，可使用 NAT 方法。这种方法需要在专用网（私网 IP）连接到因特网（公网 IP）的路由器上安装 NAT 软件。装有 NAT 软件的路由器叫做 NAT 路由器，它至少有一个有效的外部全球 IP 地址（公网 IP 地址）。这样，所有使用本地地址（私网 IP 地址）的主机在和外界通信时，都要在 NAT 路由器上将其本地地址转换成全球 IP 地址，才能和因特网连接。<br>NAT 的实现方式有三种，即静态转换 Static Nat、动态转换 Dynamic Nat 和端口多路复用 OverLoad<br>静态转换是指将内部网络的私有 IP 地址转换为公有 IP 地址，IP 地址对是一对一的，是一成不变的，某个私有 IP 地址只转换为某个公有 IP 地址。借助于静态转换，可以实现外部网络对内部网络中某些特定设备（如服务器）的访问。<br>动态转换是指将内部网络的私有 IP 地址转换为公用 IP 地址时，IP 地址是不确定的，是随机的，所有被授权访问上 Internet 的私有 IP 地址可随机转换为任何指定的合法 IP 地址。也就是说，只要指定哪些内部地址可以进行转换，以及用哪些合法地址作为外部地址时，就可以进行动态转换。动态转换可以使用多个合法外部地址集。当 ISP 提供的合法 IP 地址略少于网络内部的计算机数量时。可以采用动态转换的方式。<br>端口多路复用（Port address Translation,PAT）是指改变外出数据包的源端口并进行端口转换，即端口地址转换（PAT，Port Address Translation）. 采用端口多路复用方式。内部网络的所有主机均可共享一个合法外部 IP 地址实现对 Internet 的访问，从而可以最大限度地节约 IP 地址资源。同时，又可隐藏网络内部的所有主机，有效避免来自 internet 的攻击。因此，网络中应用最多的就是端口多路复用方式。例如，假设有两个内部主机 A 和 B，它们都使用私有 IP 地址 192.168.1.1 和 192.168.1.2，并且它们都要访问外部网络。路由器使用公网 IP 地址 203.0.113.1，并且已经配置了 PAT。当主机 A 发送数据包到外部网络时，路由器会将源 IP 地址和源端口号转换为 203.0.113.1:10000，并将数据包发送到外部网络。当主机 B 发送数据包到外部网络时，路由器会将源 IP 地址和源端口号转换为 203.0.113.1:10001，并将数据包发送到外部网络。当外部网络返回数据包时，路由器会根据目标端口号将数据包转发到相应的内部主机。</p><p>10.hids<br>HIDS（主机入侵检测系统）是一种监视计算机或网络中可疑活动的应用程序。监视的活动可以包括外部参与者创建的入侵，也可以包括内部资源或数据的滥用。HIDS 具有监视和分析计算系统内部方面以及其网络接口上的任何传入 / 传出网络数据包的能力。它通过监视操作系统操作、跟踪用户行为并在没有人类干预的情况下独立运行来检测主机上的恶意行为。<br>HIDS 则通过监测主机系统的系统日志、进程状态、文件变化等信息来检测安全事件，主要关注应用层和操作系统层的信息</p><p>11.DOM 型 XSS 和反射型 XSS 的区别<br>DOM 型 XSS 和反射型 XSS 的区别在于，DOM 型 XSS 不经过服务器，仅通过网页本身的 JavaScript 进行渲染触发，而反射型 XSS 是通过 URL 传递参数，服务器返回响应时，将参数中的恶意脚本代码反射回浏览器执行。DOM 型 XSS 的典型例子是在网页中插入一段恶意脚本代码，然后通过网页本身的 JavaScript 进行渲染触发。反射型 XSS 的典型例子是攻击者构造一个带有恶意脚本代码的 URL，然后将这个 URL 发送给受害者，当受害者点击这个 URL 时，恶意脚本代码就会被执行。</p><ol start="12"><li>内网 ip 和外网 ip 的区别<br>一般来说，10 开头的 IP 都是内网 IP，即 10.0.0.0 到 10.255.255.255 是内网 IP。而以下 IP 段的地址都是内网 IP 地址：172.16.0.0 到 172.31.255.255、192.168.0.0 到 192.168.255.255、169.254.x.x（其中 x.x 为任意数字）。如果您想判断一个 ip 是公网 IP 还是私网 ip，可以登录百度，搜索 IP 得到一个本机的外网 IP。然后打开路由器（确切的说是网关，网关可能是光猫也可能是路由器），然后登陆进入查看 WAN IP，这个是路由器连接上层网络的 IP。若 WAN IP 和百度查到的外网 IP 一致，那么这个就是公网 ip 了。</li></ol><p>13.Kerboeros 协议<br>Kerberos 协议是一种网络认证协议，用于在计算机网络上进行身份验证。它提供了一种安全的身份验证机制，以防止未经授权的访问。<br>Kerberos 协议的基本原理是：用户向 Kerberos 服务器请求一个票据，该票据用于向其他服务器证明用户的身份。Kerberos 服务器使用用户的密码来生成票据，并将其发送回用户。用户可以使用该票据来访问其他服务器，而无需再次输入密码。<br>通过过滤出 kerboros 流量，我们在 req-body 字段中，可以找到 clientName 的值，表示的就是 pc 的用户名，serverName 的两个字段一个表示服务用户名，一个是就是域名。</p><p>14.DHCP<br>DHCP 协议是一种网络协议，用于在 TCP/IP 网络上分配 IP 地址。DHCP 代表动态主机配置协议。DHCP 协议允许计算机在网络上自动获取 IP 地址，而无需手动配置。DHCP 还提供了其他信息，例如子网掩码、默认网关和 DNS 服务器的地址。DHCP 服务器是负责分配 IP 地址的服务器。DHCP 客户端是需要 IP 地址的计算机。可以帮助识别连接到网络的计算机的主机名、MAC 地址和 IP 地址。在 hostname 字段中可以找到主机名，在 clientMac 字段中可以找到主机的 mac 地址，这样我们就能把主机 - 主机 mac 地址 - IP 地址给关联起来，可以描述出网络中的主机拓扑结构。</p><p>15.dict 协议<br>Dict 协议是一个在线网络字典协议，这个协议是用来架设一个字典服务的。Dict 服务器和客户机使用 TCP 端口 2628。Dict 协议是基于查询响应的 TCP 协议，它的目标是超越 Webster protocol，并允许客户端在使用过程中访问更多字典 12.</p><p>16.redis 服务<br>Redis 是一个使用 ANSI C 编写的开源、包含多种数据结构、支持网络、基于内存、可选持久性的键值对存储数据库。它是一种 NoSQL 数据库，具有高性能、可扩展性强、高可用等优点，受到广泛开发人员和仓库管理人员的青睐。Redis 支持分布式，理论上可以无限扩展，是现在最受欢迎的 NoSQL 数据库之一。</p><p>17.gopher 协议<br>gopher 协议是一个古老且强大的协议，可以理解为是 http 协议的前身，他可以实现多个数据包整合发送。通过 gopher 协议可以攻击内网的 FTP、Telnet、Redis、Memcache，也可以进行 GET、POST 请求。</p><h1 id="web-top-10"><a class="anchor" href="#web-top-10">#</a> Web Top 10</h1><h2 id="sql-注入"><a class="anchor" href="#sql-注入">#</a> SQL 注入</h2><h3 id="原理"><a class="anchor" href="#原理">#</a> 原理</h3><p>由于程序没有细致的过滤用户输入的数据，造成 SQL 字符串拼接，进而恶意的 SQL 语句被执行，造成数据库信息泄露，网页篡改，数据库被恶意操作等。</p><h3 id="挖掘"><a class="anchor" href="#挖掘">#</a> 挖掘</h3><p>SQL 注入漏洞的位置有很多，但是最常见的是在 Web 应用程序中的输入字段，例如登录表单、搜索表单、注册表单等。攻击者可以通过在这些输入字段中注入恶意代码来执行 SQL 命令，从而获取敏感数据或控制数据库。此外，SQL 注入漏洞还可能存在于 Web 应用程序中的其他位置，例如 URL 参数、HTTP 标头、Cookie 等。</p><h3 id="方法"><a class="anchor" href="#方法">#</a> 方法</h3><p>联合注入、报错注入、延时注入、布尔注入、DNS 注入、宽字节注入、堆叠注入，二次注入。</p><h3 id="防御"><a class="anchor" href="#防御">#</a> 防御</h3><ol><li>输入验证：对用户输入进行验证，只允许输入预期的数据类型和长度。（正则过滤）</li><li>参数化查询：使用参数化查询可以防止 SQL 注入攻击。参数化查询是指将 SQL 语句和参数分开处理，参数不会被解释为 SQL 语句的一部分。（php 转义、预编译）</li><li>最小权限原则：数据库用户应该只被授予最小权限，以限制攻击者能够访问的数据。</li><li>防火墙：使用防火墙可以限制对数据库的访问，只允许来自特定 IP 地址或端口的请求。<br>5.waf 设备</li></ol><h3 id="绕过"><a class="anchor" href="#绕过">#</a> 绕过</h3><h4 id="关键字过滤"><a class="anchor" href="#关键字过滤">#</a> 关键字过滤</h4><ol><li>大小写转换</li><li>注释符绕过：--， /**/，#(%23)</li><li>内联注释绕过：/<em>!select</em>/（注释中的语句为 MYSQL 特有的语句，这些语句在其它数据库中不会运行，但会在 MYSQL 中运行）</li><li>双关键字绕过</li><li>编码绕过</li></ol><h4 id="空格过滤"><a class="anchor" href="#空格过滤">#</a> 空格过滤</h4><ol><li>使用注释符</li><li>两个空格</li><li>使用 ()</li></ol><h3 id="判断数据库类型"><a class="anchor" href="#判断数据库类型">#</a> 判断数据库类型</h3><ol><li>页面报错信息</li><li>查询数据库独有的数据表</li><li>测试各数据库独有的连接符</li><li>查询数据库版本</li></ol><h3 id="mysql-数据库站点无法连接的常见原因"><a class="anchor" href="#mysql-数据库站点无法连接的常见原因">#</a> MySQL 数据库站点无法连接的常见原因</h3><ol><li>数据库只允许本地连接</li><li>站库分离</li><li>数据库服务器端口被占用或更改了端口</li><li>访问权限不正确</li><li>数据库未启动</li></ol><h3 id="mysql-写-shell"><a class="anchor" href="#mysql-写-shell">#</a> MySQL 写 shell</h3><ol><li>通过 outfile 写入 shell</li><li>将一句话木马作为数据插入表中并查询导出</li><li>开启全局日志写入 shell</li><li>慢查询日志写入 shell（仅有在查询时间超过系统设定时间时才会写入 shell）</li></ol><h3 id="mysql-无法写-shell-的原因"><a class="anchor" href="#mysql-无法写-shell-的原因">#</a> MySQL 无法写 shell 的原因</h3><p>1.My.ini 配置 secure-file-priv 为空或 / 则可以导出导入无限制<br>2. 绝对路径不正确<br>3. 没有读写权限<br>4. 没有开启全局日志或慢查询日志</p><h2 id="ssrf"><a class="anchor" href="#ssrf">#</a> SSRF</h2><h3 id="原理-2"><a class="anchor" href="#原理-2">#</a> 原理</h3><p>服务器请求伪造，服务端提供了从其他服务器应用获取数据的功能，且没有对目标地址做过滤与限制，服务器就以服务器自己的身份去访问其他服务器的资源。</p><h3 id="挖掘-2"><a class="anchor" href="#挖掘-2">#</a> 挖掘</h3><ol><li>分享：通过 URL 地址分享网页内容</li><li>转码服务：通过 URL 地址把原地址的网页内容调优使其适合手机屏幕浏览</li><li>在线翻译：通过 URL 地址翻译对应文本内容</li><li>图片加载与下载：通过 URL 地址加载或下载图片</li><li>图片、文章收藏功能</li><li>未公开的 api 实现以及其他调用 URL 的功能</li><li>从 URL 关键字中寻找，Share、wap、url、link、src、source、target、u、3g、display、sourceURL、imageURL、domain</li></ol><h3 id="方法-2"><a class="anchor" href="#方法-2">#</a> 方法</h3><p>1.dict 协议，泄露安装软件版本信息，查看端口，操作内网 redis 服务等：dict://serverip:port / 命令：参数<br></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">curl -v &#x27;http://sec.com/ssrf.php?url=dict://127.0.0.1:6379&#x27; // 利用 dict 探测端口 </span><br></pre></td></tr></table></figure><p></p><p>2.file 协议，在有回显的情况下，利用 file 协议可以读取任意内容<br></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">curl -v &#x27;http://sec.com/ssrf.php?url=file:///etc/passwd&#x27; // 利用 file 协议查看文件 </span><br></pre></td></tr></table></figure><p></p><p>3.gopher 协议，gopher 支持发出 GET、POST 请求：可以先截获 get 请求包和 post 请求包，再构造成符合 gopher 协议的请求。gopher 协议是 ssrf 利用中一个最强大的协议 (俗称万能协议)。可用于反弹 shell<br></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">curl -v &#x27;http://sec.com/ssrf.php?url=gopher%3A%2F%2F127.0.0.1%3A6379/_....&#x27; // 利用 gopher 反弹 shell</span><br></pre></td></tr></table></figure><p></p><p>4.http/s 协议，探测内网主机存活</p><h3 id="防御-2"><a class="anchor" href="#防御-2">#</a> 防御</h3><ol><li>过滤返回信息</li><li>统一错误信息，避免用户根据错误信息判断端口状态</li><li>限制可以请求的端口</li><li>内网 ip 黑名单</li><li>禁用不需要的协议</li></ol><h3 id="绕过-2"><a class="anchor" href="#绕过-2">#</a> 绕过</h3><ol><li>采用短网址绕过</li><li>对 ip 地址进行进制转换</li><li>利用特殊域名，比如 <span class="exturl" data-url="aHR0cDovL2V4YW1wbGUuaW8=">example.io</span> 可以指向任意域名，则 <span class="exturl" data-url="aHR0cDovLzEyNy4wLjAuMS5leGFtcGxlLmlv">127.0.0.1.example.io</span> 最终会被解析为 127.0.0.1</li><li>利用 [::]，比如 <span class="exturl" data-url="aHR0cDovLzEyNy4wLjAuMQ==">http://127.0.0.1</span> &gt;&gt; http://[::127.0.0.1]</li><li>利用句号，比如 127.0.0.1 &gt;&gt; 127。0。0。1<br>7.CRLF 编码绕过</li><li>使用封闭的字母和数字</li><li>当限制只能使用 http 协议时，可以采取 302 跳转或短地址</li><li>限制为 <span class="exturl" data-url="aHR0cDovL2V4YW1wbGUuY29t">example.com</span> 域名时，采用 http 基本身份认证的方式绕过，即 <span class="exturl" data-url="aHR0cDovL3d3dy54eHguY29tQHd3dy54eGMuY29t">http://www.xxx.com@www.xxc.com</span>，在对 @解析域名中，不同的处理函数存在处理差异</li></ol><h2 id="xss"><a class="anchor" href="#xss">#</a> XSS</h2><h3 id="原理-3"><a class="anchor" href="#原理-3">#</a> 原理</h3><p>web 页面插入恶意 Js 代码，浏览器解析执行获取用户 cookie。</p><h3 id="挖掘-3"><a class="anchor" href="#挖掘-3">#</a> 挖掘</h3><ol><li>重灾区：评论区、留言区、个人信息、订单信息等</li><li>针对型：站内信、网页即时通讯、私信、意见反馈</li><li>存在风险：搜索框、当前目录、图片属性等</li></ol><h3 id="方法-3"><a class="anchor" href="#方法-3">#</a> 方法</h3><p>存储型 XSS，反射型 XSS，DOM 型 XSS</p><h3 id="防御-3"><a class="anchor" href="#防御-3">#</a> 防御</h3><ol><li>正则过滤（标签 /js 代码 / 事件）</li><li>用户的输入进行 html 编码输出（无法进行闭合）</li><li>服务端设置会话 Cookie 的 HTTP Only 属性（不能获取 cookie）</li></ol><h3 id="绕过-3"><a class="anchor" href="#绕过-3">#</a> 绕过</h3><ol><li>爆破寻找是否存在能够使用的标签和属性。</li><li>利用一些框架或模板的特性，比如在 使用 JavaScript template literal 的页面中 ，如果 `` 之间包含 ${code}，就会执行 code。</li></ol><h3 id="xss-的功能"><a class="anchor" href="#xss-的功能">#</a> XSS 的功能</h3><p>获取 cookie、获取管理员 ip、xss 蠕虫、钓鱼攻击、前端 JS 挖矿、键盘记录、屏幕截图。</p><h2 id="csrf"><a class="anchor" href="#csrf">#</a> CSRF</h2><h3 id="原理-4"><a class="anchor" href="#原理-4">#</a> 原理</h3><p>指利用受害者尚未失效的身份认证信息、（cookie、会话等），诱骗其点击恶意链接或者访问包含攻击代码的页面，在受害人不知情的情况下以受害人的身份向（身份认证信息所对应的）服务器发送请求，从而完成非法操作（转账，改密码等）。</p><h3 id="方法-4"><a class="anchor" href="#方法-4">#</a> 方法</h3><p>1.GET 型：直接改 URL 就好<br>2.POST 型：想办法利用用户数据提交表单</p><h3 id="防御-4"><a class="anchor" href="#防御-4">#</a> 防御</h3><ol><li>校验 token：让请求带上一个额外的 csrf_token，来确保请求是通过网站的前端页面发送的。这个 csrf_token 由服务器颁发，不要放到 cookie 里，要通过其他方式提供给网站的前端页面，一种方式是放到 DOM 上。前端请求时就会从 DOM 找出这个 csrf_token，作为一个参数带上，让服务端校验。</li><li>使用严格的 SameSite：Cookie 有一个 SameSite 属性，设置为严格模式（非 none 值），可以让其他网站的中跨域请求不带上 Cookie。</li><li>通过 Referer 判断：如果在网站中发送的请求，HTTP 头字段 Referer 中的域名就是当前网站。如果是其他网站发起的请求，Referer 就是这个网站域名。服务端可以利用这个 Referer 判断请求是否在网站页面中发起的。此外还可以利用 Origin 头字段，它通常在跨域请求时会携带上。但 Referer 并不完全可靠，在一些老旧的浏览器在实现上可能会有一些问题，有丢失的可能。</li><li>人机校验：加一个短信校验、邮箱校验、谷歌万恶的九宫格什么的，确保是一个人在尝试发这个请求。可以吊打所有攻击，缺点是用户体验不太好。</li></ol><h3 id="绕过-4"><a class="anchor" href="#绕过-4">#</a> 绕过</h3><h4 id="csrf_token-的位置"><a class="anchor" href="#csrf_token-的位置">#</a> CSRF_TOKEN 的位置</h4><p>前端页面中（DOM 或全局变量中）</p><h4 id="csrf_token-原理"><a class="anchor" href="#csrf_token-原理">#</a> CSRF_TOKEN 原理</h4><p>前端请求时就会从 前端页面（DOM 或全局变量）找出这个 csrf_token，作为一个参数带上，让服务端校验。</p><h4 id="csrf_token-绕过"><a class="anchor" href="#csrf_token-绕过">#</a> CSRF_TOKEN 绕过</h4><ol><li>更改请求方式</li><li>点击劫持</li><li>使用自己的 token，利用后台漏洞，替换对方的 token 进行验证</li></ol><div class="tags"><a href="/tags/web/" rel="tag"><i class="ic i-tag"></i> web</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2023-04-19 21:02:14" itemprop="dateModified" datetime="2023-04-19T21:02:14+08:00">2023-04-19</time></span></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>EricCD <i class="ic i-at"><em>@</em></i>Vegetable Blog</li><li class="link"><strong>本文链接：</strong> <a href="http://ericcd.com/2022/11/30/hvv/" title="面经">http://ericcd.com/2022/11/30/hvv/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2022/11/29/leetcode/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;ericcd-wallpaper.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_202301312148072.jpg" title="leetcode"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> LeetCode</span><h3>leetcode</h3></a></div><div class="item right"><a href="/2022/11/30/XSS-cheet-sheet/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;ericcd-wallpaper.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_202301312148074.jpg" title="XSS_cheet_sheet"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> web</span><h3>XSS_cheet_sheet</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%AA%E4%BA%BA%E7%9F%A5%E8%AF%86%E6%89%AB%E7%9B%B2"><span class="toc-number">1.</span> <span class="toc-text">个人知识扫盲</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web-top-10"><span class="toc-number">2.</span> <span class="toc-text">Web Top 10</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#sql-%E6%B3%A8%E5%85%A5"><span class="toc-number">2.1.</span> <span class="toc-text">SQL 注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-number">2.1.1.</span> <span class="toc-text">原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%96%E6%8E%98"><span class="toc-number">2.1.2.</span> <span class="toc-text">挖掘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95"><span class="toc-number">2.1.3.</span> <span class="toc-text">方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%B2%E5%BE%A1"><span class="toc-number">2.1.4.</span> <span class="toc-text">防御</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%95%E8%BF%87"><span class="toc-number">2.1.5.</span> <span class="toc-text">绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4"><span class="toc-number">2.1.5.1.</span> <span class="toc-text">关键字过滤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A9%BA%E6%A0%BC%E8%BF%87%E6%BB%A4"><span class="toc-number">2.1.5.2.</span> <span class="toc-text">空格过滤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B1%BB%E5%9E%8B"><span class="toc-number">2.1.6.</span> <span class="toc-text">判断数据库类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mysql-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AB%99%E7%82%B9%E6%97%A0%E6%B3%95%E8%BF%9E%E6%8E%A5%E7%9A%84%E5%B8%B8%E8%A7%81%E5%8E%9F%E5%9B%A0"><span class="toc-number">2.1.7.</span> <span class="toc-text">MySQL 数据库站点无法连接的常见原因</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mysql-%E5%86%99-shell"><span class="toc-number">2.1.8.</span> <span class="toc-text">MySQL 写 shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mysql-%E6%97%A0%E6%B3%95%E5%86%99-shell-%E7%9A%84%E5%8E%9F%E5%9B%A0"><span class="toc-number">2.1.9.</span> <span class="toc-text">MySQL 无法写 shell 的原因</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ssrf"><span class="toc-number">2.2.</span> <span class="toc-text">SSRF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-2"><span class="toc-number">2.2.1.</span> <span class="toc-text">原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%96%E6%8E%98-2"><span class="toc-number">2.2.2.</span> <span class="toc-text">挖掘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95-2"><span class="toc-number">2.2.3.</span> <span class="toc-text">方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%B2%E5%BE%A1-2"><span class="toc-number">2.2.4.</span> <span class="toc-text">防御</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%95%E8%BF%87-2"><span class="toc-number">2.2.5.</span> <span class="toc-text">绕过</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#xss"><span class="toc-number">2.3.</span> <span class="toc-text">XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-3"><span class="toc-number">2.3.1.</span> <span class="toc-text">原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%96%E6%8E%98-3"><span class="toc-number">2.3.2.</span> <span class="toc-text">挖掘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95-3"><span class="toc-number">2.3.3.</span> <span class="toc-text">方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%B2%E5%BE%A1-3"><span class="toc-number">2.3.4.</span> <span class="toc-text">防御</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%95%E8%BF%87-3"><span class="toc-number">2.3.5.</span> <span class="toc-text">绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#xss-%E7%9A%84%E5%8A%9F%E8%83%BD"><span class="toc-number">2.3.6.</span> <span class="toc-text">XSS 的功能</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#csrf"><span class="toc-number">2.4.</span> <span class="toc-text">CSRF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-4"><span class="toc-number">2.4.1.</span> <span class="toc-text">原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95-4"><span class="toc-number">2.4.2.</span> <span class="toc-text">方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%B2%E5%BE%A1-4"><span class="toc-number">2.4.3.</span> <span class="toc-text">防御</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%95%E8%BF%87-4"><span class="toc-number">2.4.4.</span> <span class="toc-text">绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#csrf_token-%E7%9A%84%E4%BD%8D%E7%BD%AE"><span class="toc-number">2.4.4.1.</span> <span class="toc-text">CSRF_TOKEN 的位置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#csrf_token-%E5%8E%9F%E7%90%86"><span class="toc-number">2.4.4.2.</span> <span class="toc-text">CSRF_TOKEN 原理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#csrf_token-%E7%BB%95%E8%BF%87"><span class="toc-number">2.4.4.3.</span> <span class="toc-text">CSRF_TOKEN 绕过</span></a></li></ol></li></ol></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/2022/07/17/url-log/" rel="bookmark" title="web 安全相关网站资源记录">web 安全相关网站资源记录</a></li><li><a href="/2022/07/23/vulhub-command/" rel="bookmark" title="vulhub 相关命令">vulhub 相关命令</a></li><li><a href="/2022/08/20/file-download/" rel="bookmark" title="文件包含漏洞可以尝试下载的文件">文件包含漏洞可以尝试下载的文件</a></li><li><a href="/2022/09/20/pikachu/" rel="bookmark" title="pikachu">pikachu</a></li><li><a href="/2022/11/15/information-collection/" rel="bookmark" title="information-collection">information-collection</a></li><li><a href="/2022/11/22/BurpLab/" rel="bookmark" title="BurpLab">BurpLab</a></li><li><a href="/2022/11/30/XSS-cheet-sheet/" rel="bookmark" title="XSS_cheet_sheet">XSS_cheet_sheet</a></li><li class="active"><a href="/2022/11/30/hvv/" rel="bookmark" title="面经">面经</a></li><li><a href="/2022/12/22/BurpLab-2/" rel="bookmark" title="BurpLab_2-Authentication">BurpLab_2-Authentication</a></li><li><a href="/2022/12/22/BurpLab-3/" rel="bookmark" title="BurpLab_3-Directory_traversal">BurpLab_3-Directory_traversal</a></li><li><a href="/2022/12/22/BurpLab-4/" rel="bookmark" title="BurpLab_4-OS_command_injection">BurpLab_4-OS_command_injection</a></li><li><a href="/2022/12/22/BurpLab-5/" rel="bookmark" title="BurpLab_5-Business_logic_vulnerabilities">BurpLab_5-Business_logic_vulnerabilities</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="EricCD" data-src="/images/avatar.jpg"><p class="name" itemprop="name">EricCD</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">28</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">8</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">18</span> <span class="name">标签</span></a></div></nav><div class="social"></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2022/11/29/leetcode/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2022/11/30/XSS-cheet-sheet/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/Android/" title="分类于 Android">Android</a></div><span><a href="/2022/03/23/AndroidFramework-init/" title="Android 框架 - init 进程">Android 框架 - init 进程</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Android/" title="分类于 Android">Android</a></div><span><a href="/2022/07/19/aosp-related/" title="aosp 配置">aosp 配置</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/web/" title="分类于 web">web</a></div><span><a href="/2022/08/20/file-download/" title="文件包含漏洞可以尝试下载的文件">文件包含漏洞可以尝试下载的文件</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Android%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/" title="分类于 Android逆向工具">Android逆向工具</a></div><span><a href="/2022/02/27/Android-reverce-2022.2.27-2/" title="Android 逆向学习 - 2022.2.27-2">Android 逆向学习 - 2022.2.27-2</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/web/" title="分类于 web">web</a></div><span><a href="/2022/12/22/BurpLab-3/" title="BurpLab_3-Directory_traversal">BurpLab_3-Directory_traversal</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/web/" title="分类于 web">web</a></div><span><a href="/2022/12/22/BurpLab-2/" title="BurpLab_2-Authentication">BurpLab_2-Authentication</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/web/" title="分类于 web">web</a></div><span><a href="/2022/07/23/vulhub-command/" title="vulhub 相关命令">vulhub 相关命令</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Android/" title="分类于 Android">Android</a></div><span><a href="/2022/03/23/Android-framework/" title="Android 框架概述">Android 框架概述</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/web/" title="分类于 web">web</a></div><span><a href="/2022/11/30/hvv/" title="面经">面经</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Android%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/" title="分类于 Android逆向工具">Android逆向工具</a></div><span><a href="/2022/02/27/android-reverce-2022.2.27-1/" title="Android 逆向学习 - 2022.2.27-1">Android 逆向学习 - 2022.2.27-1</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">EricCD @ Yume Shoka</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2022/11/30/hvv/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html>